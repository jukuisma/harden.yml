---
- hosts: localhost
  vars_files:
    - vars.yml
  tasks:
    - name: Check OS version
      ansible.builtin.assert:
        that:
          - (ansible_distribution == "Slackware" and ansible_distribution_major_version | int >= 15) or (ansible_distribution == "Debian" and ansible_distribution_major_version | int >= 11) or (ansible_distribution == "CentOS" and ansible_distribution_major_version == "7") # noqa yaml[line-length]
        msg: "Unsupported operating system"
    - ansible.builtin.import_tasks: tasks/sudoers.yml
      tags: sudo
    - ansible.builtin.import_tasks: tasks/lynis.yml
    - ansible.builtin.import_tasks: tasks/filesystem.yml
    - ansible.builtin.import_tasks: tasks/ca-certs.yml
    - ansible.builtin.import_tasks: tasks/debian_packages.yml
    - ansible.builtin.import_tasks: tasks/audit.yml
      tags: audit
    - ansible.builtin.import_tasks: tasks/login_defs.yml
    - ansible.builtin.import_tasks: tasks/pam.yml
    - ansible.builtin.import_tasks: tasks/services.yml
    - ansible.builtin.import_tasks: tasks/kernel.yml
    - ansible.builtin.import_tasks: tasks/services-accounting.yml
    - ansible.builtin.import_tasks: tasks/apparmor.yml
      tags:
        - apparmor
        - debian
    - ansible.builtin.import_tasks: tasks/logging.yml
    - ansible.builtin.import_tasks: tasks/misc.yml
    - ansible.builtin.import_tasks: tasks/banners.yml
    - ansible.builtin.import_tasks: tasks/network.yml
    - ansible.builtin.import_tasks: tasks/entropy.yml
    - ansible.builtin.import_tasks: tasks/rkhunter.yml
    - ansible.builtin.import_tasks: tasks/clamav.yml
    - ansible.builtin.import_tasks: tasks/display_managers.yml
    - ansible.builtin.import_tasks: tasks/apache.yml
    - ansible.builtin.import_tasks: tasks/cgroup.yml

  handlers:
    - ansible.builtin.import_tasks: tasks/handlers.yml
